{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet currentPage = 1;\nlet searchQuery = '';\nconst perPage = 40;\n\nconst options = {\n  captionsData: 'alt',\n  captionsDelay: 250,\n};\nconst lightbox = new SimpleLightbox('.image-card', options);\n\nconst form = document.querySelector('form');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\n\nhideLoader();\nhideLoadMoreButton();\n\nform.addEventListener('submit', async function (event) {\n  event.preventDefault();\n  clearImages();\n\n  searchQuery = document.querySelector('input').value.trim();\n  if (searchQuery === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query.',\n    });\n    return;\n  }\n  showLoader();\n  currentPage = 1;\n  try {\n    const data = await searchImages(searchQuery, currentPage);\n    hideLoader();\n    if (data.hits.length > 0) {\n      appendImages(data.hits);\n      lightbox.refresh();\n      if (data.totalHits <= perPage) {\n        hideLoadMoreButton();\n      } else {\n        showLoadMoreButton();\n      }\n    } else {\n      showNoResultsMessage();\n      clearImages();\n      hideLoadMoreButton();\n    }\n  } catch (error) {\n    hideLoader();\n    console.error('Error fetching images:', error.message);\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred while fetching images. Please try again.',\n    });\n  }\n});\n\nloadMoreButton.addEventListener('click', async function () {\n  showLoader();\n  currentPage++;\n  try {\n    const data = await searchImages(searchQuery, currentPage);\n    hideLoader();\n    if (data.totalHits > 0) {\n      appendImages(data.hits);\n      lightbox.refresh();\n      scrollToNextGroup();\n      if (data.totalHits <= currentPage * perPage) {\n        hideLoadMoreButton();\n        showEndMessage();\n      }\n    } else {\n      hideLoadMoreButton();\n      showEndMessage();\n    }\n  } catch (error) {\n    hideLoader();\n    console.error('Error fetching more images:', error.message);\n    iziToast.error({\n      title: 'Error',\n      message:\n        'An error occurred while fetching more images. Please try again.',\n    });\n  }\n});\n\nasync function searchImages(query, page) {\n  const apiKey = '42011600-6d993b5d4f0ba2a9af1a5ffd0';\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&pretty=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(apiUrl);\n    if (response.status !== 200) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n    return response.data;\n  } catch (error) {\n    throw new Error(`Error fetching data: ${error.message}`);\n  }\n}\n\nfunction appendImages(images) {\n  const imageMarkup = images\n    .map(\n      image => `\n        <li class=\"image-item\">\n          <a href=\"${image.largeImageURL}\" class=\"image-card\">\n            <div class=\"image-container\">\n              <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n            </div>\n            <div class=\"image-info\">\n              <span><span class=\"label\">Likes</span> ${image.likes}</span>\n              <span><span class=\"label\">Views</span> ${image.views}</span>\n              <span><span class=\"label\">Comments</span> ${image.comments}</span>\n              <span><span class=\"label\">Downloads</span> ${image.downloads}</span>\n            </div>\n          </a>\n        </li>\n      `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', imageMarkup);\n}\n\nfunction clearImages() {\n  gallery.innerHTML = '';\n}\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction showNoResultsMessage() {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.style.visibility = 'visible';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.style.visibility = 'hidden';\n}\n\nfunction showEndMessage() {\n  iziToast.info({\n    title: 'Info',\n    message: 'We are sorry, but you have reached the end of search results.',\n  });\n}\n\nfunction scrollToNextGroup() {\n  const cardHeight = document\n    .querySelector('.image-card')\n    .getBoundingClientRect().height;\n\n  const numberOfCardsToScroll = 4;\n\n  const currentPosition = window.scrollY;\n  const targetPosition = currentPosition + cardHeight * numberOfCardsToScroll;\n\n  window.scrollTo({\n    top: targetPosition,\n    behavior: 'smooth',\n  });\n}\n"],"names":["currentPage","searchQuery","perPage","options","lightbox","SimpleLightbox","form","loader","gallery","loadMoreButton","hideLoader","hideLoadMoreButton","event","clearImages","iziToast","showLoader","data","searchImages","appendImages","showLoadMoreButton","showNoResultsMessage","error","scrollToNextGroup","showEndMessage","query","page","apiUrl","response","axios","images","imageMarkup","image","cardHeight","numberOfCardsToScroll","targetPosition"],"mappings":"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"}